(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{310:function(e,t,n){"use strict";n.r(t);n(43),n(121),n(122),n(42);var r,o,c,l=n(3),d={props:["data"],data:function(){return{search:"",pagination:1}},methods:{AgreeRemove:function(e,t){var n=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.$axios.delete("/api/result/"+t.id);case 2:return r=e.sent,r.data,e.abrupt("return",n.data=n.data.filter((function(e){var n=e.id;return t.id!==n})));case 5:case"end":return e.stop()}}),e)})))()}}},m=n(11),f={components:{Result:Object(m.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.data.filter((function(data){return!e.search||data.email.toLowerCase().includes(e.search.toLowerCase())})),height:"500",border:!1,"highlight-current-row":!1,stripe:!1,lazy:!1,"show-summary":!1,"tooltip-effect":"light"}},[n("el-table-column",{attrs:{type:"index",label:"STT",align:"left",sortable:!1,fixed:!1,width:"180"}}),e._v(" "),n("el-table-column",{attrs:{label:"Email",prop:"email",align:"left",sortable:!1,fixed:!1,width:"180"}}),e._v(" "),n("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:"success",closable:!1,effect:"light",size:"medium","disable-transitions":!1}},[e._v("Success")])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popconfirm",{attrs:{title:"Bạn có chắc chắn muốn xóa?",confirmButtonText:"OK",cancelButtonText:"Hủy",icon:"el-icon-info",iconColor:"red"},on:{onConfirm:function(n){return e.AgreeRemove(t.$index,t.row)}}},[n("el-button",{attrs:{slot:"reference",round:"",size:"mini",type:"danger",icon:"el-icon-delete"},slot:"reference"})],1)]}}])})],1)}),[],!1,null,"65b3e8ca",null).exports},data:function(){return{data:[],count:0,command:"",title:"Phân Loại",hold:!0,domain:[],domain_add_value:"@"}},created:(c=Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDomain();case 2:return e.next=4,this.loadData();case 4:return e.next=6,this.loadCount();case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)}),methods:{add_domain:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.domain_add_value.includes("@")){t.next=2;break}return t.abrupt("return",e.$message({message:"Phải nhập đúng định dạng @name.com",type:"error"}));case 2:return t.next=4,e.$axios.post("/api/domain",{name:e.domain_add_value});case 4:n=t.sent,data=n.data,e.domain.unshift(data),e.$message({message:"Thêm "+e.domain_add_value+" thành công.",type:"success"}),e.domain_add_value="@";case 9:case"end":return t.stop()}}),t)})))()},handleDelete:function(e,t){var n=this;return Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.$axios.delete("/api/domain/"+t.id);case 2:return n.domain=n.domain.filter((function(e){return e.id!==t.id})),e.abrupt("return",n.$message({message:"Đã xóa "+t.name,type:"success"}));case 4:case"end":return e.stop()}}),e)})))()},loadDomain:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/api/domain");case 2:n=t.sent,data=n.data,e.domain=data;case 5:case"end":return t.stop()}}),t)})))()},filterDomain:function(e,t){var n=this;return Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"all"===(t=t.name)?(n.title="Phân Loại",n.command=t=""):(n.title=t,n.command=t),e.next=4,n.loadCount(t);case 4:return e.next=6,n.loadData();case 6:case"end":return e.stop()}}),e)})))()},loadCount:(o=Object(l.a)(regeneratorRuntime.mark((function e(){var t,n,data,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",e.next=3,this.$axios.get("/api/result/count?command="+t);case 3:return n=e.sent,data=n.data,e.abrupt("return",this.count=data);case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)}),loadData:(r=Object(l.a)(regeneratorRuntime.mark((function e(){var t,n,data,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:1,e.next=3,this.$axios.get('/api/result?limit=30&where={"email":{"contains":"'+this.command+'"}}&skip='+30*(t-1));case 3:return n=e.sent,data=n.data,e.abrupt("return",this.data=data);case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)}),onCancel:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.download(!1),e.data=[];case 2:case"end":return t.stop()}}),t)})))()},onConfirm:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.download(!0);case 1:case"end":return t.stop()}}),t)})))()},loadMore:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.loadData(parseInt(e));case 2:case"end":return n.stop()}}),n)})))()},forceFileDownload:function(e){var t=window.URL.createObjectURL(new Blob([e.data])),link=document.createElement("a");link.href=t,link.setAttribute("download","file.txt"),document.body.appendChild(link),link.click()},download:function(e){var t=this;this.$axios({method:"post",url:"/api/email/download",data:{domain:this.command,hold:e},responseType:"arraybuffer"}).then((function(e){t.forceFileDownload(e)}))}}},h=Object(m.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",[n("el-col",{attrs:{span:20,offset:2}},[n("el-row",[n("el-col",{attrs:{justify:"right"}},[e._v("\n\t\t\t\t\tDanh sách kết quả quét THÀNH CÔNG "+e._s(e.count)+" kết quả !\n\n\t\t\t\t\t"),n("el-popconfirm",{attrs:{title:"Giữ lại dữ liệu sau khi tải xuống?",confirmButtonText:"Đồng ý",cancelButtonText:"Xóa",icon:"el-icon-info",iconColor:"red"},on:{onCancel:e.onCancel,onConfirm:e.onConfirm}},[n("el-button",{staticStyle:{float:"right"},attrs:{slot:"reference",justify:"right",type:"",icon:"",loading:!1,plain:!1,round:!1,circle:!1,autofocus:!1,size:"small",disabled:!1},slot:"reference"},[e._v("Tải về "+e._s(e.count)+" Email")])],1),e._v(" "),n("el-popover",{staticStyle:{float:"right","margin-right":"10px"},attrs:{placement:"top-start",title:"Có "+e.domain.length+" domain",trigger:"click",width:"240",transition:"el-fade-in-linear"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.domain,height:"auto",border:!1,"highlight-current-row":!1,stripe:!1,lazy:!1,"show-summary":!1,"tooltip-effect":"light"}},[n("el-table-column",{attrs:{type:"index",align:"left",sortable:!1,fixed:!1,width:"20"}}),e._v(" "),n("el-table-column",{attrs:{label:"Domain",prop:"name",align:"left",sortable:!1,fixed:!1,width:"140"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",width:"80"},scopedSlots:e._u([{key:"header",fn:function(t){return[n("el-popover",{attrs:{placement:"top-start",trigger:"click",title:"Thêm domain",width:"200",transition:"el-fade-in-linear"}},[n("el-input",{attrs:{placeholder:"@...",size:"mini",clearable:"",type:"text",autosize:!1,disabled:!1,autocomplete:"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.add_domain(t)}},model:{value:e.domain_add_value,callback:function(t){e.domain_add_value=t},expression:"domain_add_value"}}),e._v(" "),n("el-button",{attrs:{slot:"reference",type:"primary",icon:"",loading:!1,plain:!1,round:!1,circle:!1,autofocus:!1,size:"mini",disabled:!1},slot:"reference"},[e._v("Add")])],1)]}},{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",icon:"el-icon-view",size:"mini"},on:{click:function(n){return e.filterDomain(t.$index,t.row)}}}),e._v(" "),n("el-button",{attrs:{type:"text",icon:"el-icon-error",size:"mini"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}})]}}])})],1),e._v(" "),n("el-button",{attrs:{slot:"reference",type:"default",icon:"",loading:!1,plain:!1,round:!1,circle:!1,autofocus:!1,size:"small",disabled:!1},slot:"reference"},[e._v(e._s(e.title))])],1)],1)],1),e._v(" "),n("Result",{attrs:{data:e.data}}),e._v(" "),n("br"),e._v(" "),n("el-pagination",{attrs:{total:e.count,"page-size":30,"pager-count":11,"prev-text":"","next-text":"","hide-on-single-page":!1,background:"",layout:"prev, pager, next"},on:{"current-change":e.loadMore}})],1)],1)}),[],!1,null,"13fae0e5",null);t.default=h.exports}}]);
exports.ids=[2],exports.modules={80:function(t,e,n){"use strict";n.r(e);var o={props:["data"],data:()=>({search:"",pagination:1}),methods:{async AgreeRemove(t,e){let{data:data}=await this.$axios.delete("/api/result/"+e.id);return this.data=this.data.filter(({id:t})=>e.id!==t)}}},l=n(1);var r={components:{Result:Object(l.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.data.filter((function(data){return!t.search||data.email.toLowerCase().includes(t.search.toLowerCase())})),height:"500",border:!1,"highlight-current-row":!1,stripe:!1,lazy:!1,"show-summary":!1,"tooltip-effect":"light"}},[n("el-table-column",{attrs:{type:"index",label:"STT",align:"left",sortable:!1,fixed:!1,width:"180"}}),t._v(" "),n("el-table-column",{attrs:{label:"Email",prop:"email",align:"left",sortable:!1,fixed:!1,width:"180"}}),t._v(" "),n("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:"success",closable:!1,effect:"light",size:"medium","disable-transitions":!1}},[t._v("Success")])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popconfirm",{attrs:{title:"Bạn có chắc chắn muốn xóa?",confirmButtonText:"OK",cancelButtonText:"Hủy",icon:"el-icon-info",iconColor:"red"},on:{onConfirm:function(n){return t.AgreeRemove(e.$index,e.row)}}},[n("el-button",{attrs:{slot:"reference",round:"",size:"mini",type:"danger",icon:"el-icon-delete"},slot:"reference"})],1)]}}])})],1)}),[],!1,(function(t){}),"65b3e8ca","9aabccbe").exports},data:()=>({data:[],count:0,command:"",title:"Phân Loại",hold:!0,domain:[],domain_add_value:"@"}),created:async function(){await this.loadDomain(),await this.loadData(),await this.loadCount()},methods:{async add_domain(){if(!this.domain_add_value.includes("@"))return this.$message({message:"Phải nhập đúng định dạng @name.com",type:"error"});let{data:data}=await this.$axios.post("/api/domain",{name:this.domain_add_value});this.domain.unshift(data),this.$message({message:"Thêm "+this.domain_add_value+" thành công.",type:"success"}),this.domain_add_value="@"},async handleDelete(t,e){return await this.$axios.delete("/api/domain/"+e.id),this.domain=this.domain.filter(({id:t})=>t!==e.id),this.$message({message:"Đã xóa "+e.name,type:"success"})},async loadDomain(){let{data:data}=await this.$axios.get("/api/domain");this.domain=data},async filterDomain(t,e){"all"===(e=e.name)?(this.title="Phân Loại",this.command=e=""):(this.title=e,this.command=e),await this.loadCount(e),await this.loadData()},loadCount:async function(t=""){let{data:data}=await this.$axios.get("/api/result/count?command="+t);return this.count=data},loadData:async function(t=1){let{data:data}=await this.$axios.get('/api/result?limit=30&where={"email":{"contains":"'+this.command+'"}}&skip='+30*(t-1));return this.data=data},async onCancel(){this.download(!1),this.data=[]},async onConfirm(){this.download(!0)},async loadMore(t){await this.loadData(parseInt(t))},forceFileDownload(t){const e=window.URL.createObjectURL(new Blob([t.data])),link=document.createElement("a");link.href=e,link.setAttribute("download","file.txt"),document.body.appendChild(link),link.click()},download(t){this.$axios({method:"post",url:"/api/email/download",data:{domain:this.command,hold:t},responseType:"arraybuffer"}).then(t=>{this.forceFileDownload(t)})}}};var d=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-row",[n("el-col",{attrs:{span:20,offset:2}},[n("el-row",[n("el-col",{attrs:{justify:"right"}},[t._v("\n\t\t\t\t\tDanh sách kết quả quét THÀNH CÔNG "+t._s(t.count)+" kết quả !\n\n\t\t\t\t\t"),n("el-popconfirm",{attrs:{title:"Giữ lại dữ liệu sau khi tải xuống?",confirmButtonText:"Đồng ý",cancelButtonText:"Xóa",icon:"el-icon-info",iconColor:"red"},on:{onCancel:t.onCancel,onConfirm:t.onConfirm}},[n("el-button",{staticStyle:{float:"right"},attrs:{slot:"reference",justify:"right",type:"",icon:"",loading:!1,plain:!1,round:!1,circle:!1,autofocus:!1,size:"small",disabled:!1},slot:"reference"},[t._v("Tải về "+t._s(t.count)+" Email")])],1),t._v(" "),n("el-popover",{staticStyle:{float:"right","margin-right":"10px"},attrs:{placement:"top-start",title:"Có "+t.domain.length+" domain",trigger:"click",width:"240",transition:"el-fade-in-linear"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.domain,height:"auto",border:!1,"highlight-current-row":!1,stripe:!1,lazy:!1,"show-summary":!1,"tooltip-effect":"light"}},[n("el-table-column",{attrs:{type:"index",align:"left",sortable:!1,fixed:!1,width:"20"}}),t._v(" "),n("el-table-column",{attrs:{label:"Domain",prop:"name",align:"left",sortable:!1,fixed:!1,width:"140"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",width:"80"},scopedSlots:t._u([{key:"header",fn:function(e){return[n("el-popover",{attrs:{placement:"top-start",trigger:"click",title:"Thêm domain",width:"200",transition:"el-fade-in-linear"}},[n("el-input",{attrs:{placeholder:"@...",size:"mini",clearable:"",type:"text",autosize:!1,disabled:!1,autocomplete:"off"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.add_domain(e)}},model:{value:t.domain_add_value,callback:function(e){t.domain_add_value=e},expression:"domain_add_value"}}),t._v(" "),n("el-button",{attrs:{slot:"reference",type:"primary",icon:"",loading:!1,plain:!1,round:!1,circle:!1,autofocus:!1,size:"mini",disabled:!1},slot:"reference"},[t._v("Add")])],1)]}},{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",icon:"el-icon-view",size:"mini"},on:{click:function(n){return t.filterDomain(e.$index,e.row)}}}),t._v(" "),n("el-button",{attrs:{type:"text",icon:"el-icon-error",size:"mini"},on:{click:function(n){return t.handleDelete(e.$index,e.row)}}})]}}])})],1),t._v(" "),n("el-button",{attrs:{slot:"reference",type:"default",icon:"",loading:!1,plain:!1,round:!1,circle:!1,autofocus:!1,size:"small",disabled:!1},slot:"reference"},[t._v(t._s(t.title))])],1)],1)],1),t._v(" "),n("Result",{attrs:{data:t.data}}),t._v(" "),n("br"),t._v(" "),n("el-pagination",{attrs:{total:t.count,"page-size":30,"pager-count":11,"prev-text":"","next-text":"","hide-on-single-page":!1,background:"",layout:"prev, pager, next"},on:{"current-change":t.loadMore}})],1)],1)}),[],!1,(function(t){}),"13fae0e5","24299dcd");e.default=d.exports}};